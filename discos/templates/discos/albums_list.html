{% extends "discos/base.html" %}

{% load static %}

{% block content %}

{% if user.is_staff %}

  <header>
    <div class="row justify-content-center">
      <div class="col-md-7 col-sm-10">
          <h1>Listado de Álbumes</h1>
      </div>
      <div class="col-md-3 col-sm-10">
        <div class="container-btn">
          <button class="btn btn-light" id="btnAgregar">
            <a href="{% url 'albumsAdd' %}">Agregar Álbum</a>
          </button>
        </div>
      </div>
    </div>  
  </header>

  <div class="row justify-content-center">
    <div class="col-10">

      <div id="idMensajes">
        {% if mensaje %}
            <div class="alert alert-warning mx-auto">
                {{ mensaje }}
            </div>
        {% endif %}
      </div>

      <div class="table-container">
        <table class="table table-striped">
            {% if albums %}
                <thead>
                    <tr>
                    <th scope="col">Artista</th>
                    <th scope="col">Álbum</th>
                    <th scope="col">Género</th>
                    <th scope="col">Lanzamiento</th>
                    <th scope="col">Precio</th>
                    <th scope="col">Formato</th>
                    <th scope="col">Stock</th>
                    <th scope="col" colspan="2">Acción</th>
                    </tr>
                </thead>
                <tbody>
                    {% for album in albums %}
                        <tr>
                            <td>{{ album.id_artista }}</td>
                            <td>{{ album.nombre_disco }}</td>
                            <td>{{ album.id_genero }}</td>
                            <td>{{ album.fecha_lanzamiento|date:"d/m/Y" }}</td>
                            <td>${{ album.precio }}</td>
                            <td>{{ album.id_formato }}</td>
                            <td>{{ album.stock }}</td>
                            <td class="td-update equal-width"><a href="{% url 'albums_edit' pk=album.id_album %}">Modificar</a></td> 
                            <td class="td-delete equal-width"><a href="{% url 'albums_del' pk=album.id_album %}">Eliminar</a></td>
                        </tr>
                    {% endfor %}
                </tbody>
            {% endif %}    
        </table>

        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
            {% if albums.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ albums.previous_page_number }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <a class="page-link" href="#" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
            {% endif %}
            
            {% for num in albums.paginator.page_range %}
              {% if albums.number == num %}
                <li class="page-item active"><a class="page-link" href="#">{{ num }}</a></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}
            
            {% if albums.has_next %}
              <li class="page-item">
                <a class="page-link" href="?page={{ albums.next_page_number }}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <a class="page-link" href="#" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
  </div>

{% else %}
  <div class="container-permisos">
    <h1>Error</h1>
    <p>No tienes permisos para ver esta página</p>
  </div>
{% endif %}

{% endblock %}
